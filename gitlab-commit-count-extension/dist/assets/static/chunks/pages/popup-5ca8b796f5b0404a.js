(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{5513:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var r=n(7876),l=n(4232);let i=()=>{let[t,e]=(0,l.useState)(null),[n,i]=(0,l.useState)({}),[a,s]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[u,d]=(0,l.useState)(null);(0,l.useEffect)(()=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{var e;let n=null===(e=t[0])||void 0===e?void 0:e.url;n&&n.includes("gitlab.com")?d(h(n)):(s("Not a GitLab page"),c(!1))})},[]);let h=t=>{try{let e=new URL(t);if(!e.hostname.includes("gitlab"))return null;let n=e.pathname.split("/").filter(Boolean);if(n.length>=2){let t=e.pathname,r=t.indexOf("/-/");if(-1===r)return n[n.length-1];{let e=t.substring(1,r).split("/");return e[e.length-1]}}return null}catch(t){return console.error("Error parsing URL:",t),null}},p=async()=>{if(!u){s("No GitLab project detected"),c(!1);return}try{c(!0);let t=await fetch("https://extension-backend-production-1c13.up.railway.app/commits?projectName=".concat(encodeURIComponent(u)));if(!t.ok)throw Error("Server responded with status: ".concat(t.status));let n=await t.json();e(n.total_commits),i(n.author_commit_count),s(null)}catch(t){console.error("Error fetching commit data:",t),s("Failed to fetch data: ".concat(t))}finally{c(!1)}};return(0,l.useEffect)(()=>{u&&p()},[u]),(0,r.jsxs)("div",{style:{padding:"10px",width:"250px",fontFamily:"Arial"},children:[(0,r.jsx)("h2",{children:"GitLab Commit Stats"}),o&&(0,r.jsx)("p",{children:"Loading data..."}),u&&(0,r.jsxs)("p",{children:["Project: ",u]}),a?(0,r.jsxs)("div",{style:{color:"red"},children:[(0,r.jsx)("p",{children:a}),(0,r.jsx)("button",{onClick:p,children:"Retry"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["Total Commits: ",null!=t?t:"N/A"]}),(0,r.jsx)("div",{children:Object.entries(n).map(t=>{let[e,n]=t;return(0,r.jsxs)("p",{children:[e,": ",n," commits"]},e)})})]})]})}},6373:(t,e,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/popup",function(){return n(5513)}])}},t=>{var e=e=>t(t.s=e);t.O(0,[636,593,792],()=>e(6373)),_N_E=t.O()}]);