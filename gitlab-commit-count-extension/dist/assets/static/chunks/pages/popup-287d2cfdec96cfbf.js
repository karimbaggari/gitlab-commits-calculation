(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{5513:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>i});var n=r(7876),l=r(4232);let i=()=>{let[t,e]=(0,l.useState)(null),[r,i]=(0,l.useState)({}),[a,s]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[u,d]=(0,l.useState)(null);(0,l.useEffect)(()=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{var e;let r=null===(e=t[0])||void 0===e?void 0:e.url;r&&r.includes("gitlab.com")?d(h(r)):(s("Not a GitLab page"),c(!1))})},[]);let h=t=>{try{let e=new URL(t);if(!e.hostname.includes("gitlab"))return null;let r=e.pathname.split("/").filter(Boolean);if(r.length>=2){let t=e.pathname,n=t.indexOf("/-/");if(-1===n)return r[r.length-1];{let e=t.substring(1,n).split("/");return e[e.length-1]}}return null}catch(t){return console.error("Error parsing URL:",t),null}},p=async()=>{if(!u){s("No GitLab project detected"),c(!1);return}try{c(!0);let t=await fetch("http://localhost:8000/commits?projectName=".concat(encodeURIComponent(u)));if(!t.ok)throw Error("Server responded with status: ".concat(t.status));let r=await t.json();e(r.total_commits),i(r.author_commit_count),s(null)}catch(t){console.error("Error fetching commit data:",t),s("Failed to fetch data: ".concat(t))}finally{c(!1)}};return(0,l.useEffect)(()=>{u&&p()},[u]),(0,n.jsxs)("div",{style:{padding:"10px",width:"250px",fontFamily:"Arial"},children:[(0,n.jsx)("h2",{children:"GitLab Commit Stats"}),o&&(0,n.jsx)("p",{children:"Loading data..."}),u&&(0,n.jsxs)("p",{children:["Project: ",u]}),a?(0,n.jsxs)("div",{style:{color:"red"},children:[(0,n.jsx)("p",{children:a}),(0,n.jsx)("button",{onClick:p,children:"Retry"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["Total Commits: ",null!=t?t:"N/A"]}),(0,n.jsx)("div",{children:Object.entries(r).map(t=>{let[e,r]=t;return(0,n.jsxs)("p",{children:[e,": ",r," commits"]},e)})})]})]})}},6373:(t,e,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/popup",function(){return r(5513)}])}},t=>{var e=e=>t(t.s=e);t.O(0,[636,593,792],()=>e(6373)),_N_E=t.O()}]);